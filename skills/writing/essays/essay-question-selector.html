<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
<title>Essay Question Selector — INTUITY</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=DM+Sans:wght@400;500;700&display=swap" rel="stylesheet"/>
<style>
:root{
  --bg:#0c0c0c;--gold:#C9A961;--gold-d:#9B7D3A;--gold-l:#E8D4A0;
  --white:#FAFAF8;--ink:#0d0d0d;
  --health:#4CAF50;--health-bg:rgba(76,175,80,0.1);
  --entertain:#FF6B6B;--entertain-bg:rgba(255,107,107,0.1);
  --tech:#4A90E2;--tech-bg:rgba(74,144,226,0.1);
}
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent}
html,body{width:100%;height:100%;overflow:hidden;position:fixed;background:var(--bg);font-family:'Inter',sans-serif;color:#fff;-webkit-font-smoothing:antialiased;}
.shell{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;padding:2vh 3vw;}
.card{width:100%;height:100%;max-width:900px;max-height:95vh;background:var(--white);border-radius:1.5rem;box-shadow:0 0 0 1px rgba(201,169,97,0.15),0 24px 80px rgba(0,0,0,0.65),0 4px 16px rgba(0,0,0,0.4);display:flex;flex-direction:column;overflow:hidden;position:relative;}
.card::before{content:'';position:absolute;top:0;left:0;right:0;height:3px;background:linear-gradient(90deg,var(--gold-d),var(--gold-l),var(--gold-d));z-index:5;}
.card-brand{flex-shrink:0;display:flex;align-items:center;justify-content:space-between;padding:1rem 1.5rem 0.75rem;margin-top:3px;position:relative;border-bottom:1px solid rgba(0,0,0,0.06);}
.home-link{text-decoration:none;font-family:'Inter',sans-serif;font-size:1rem;font-weight:600;color:var(--gold);transition:all 0.2s;padding:0.4rem 0.6rem;border-radius:0.5rem;display:flex;align-items:center;gap:0.3rem;}
.home-link:hover{background:rgba(201,169,97,0.1);color:var(--gold-d);}
.home-link:active{transform:scale(0.95);}
.menu-btn{background:#000;border:1px solid rgba(0,0,0,0.12);width:32px;height:32px;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all 0.2s;}
.menu-btn:hover{background:rgba(0,0,0,0.85);}
.menu-btn:active{transform:scale(0.95);}
.menu-dots{display:flex;gap:4px;}
.menu-dots span{width:4px;height:4px;border-radius:50%;background:#fff;}
.menu-dropdown{position:absolute;top:calc(100% + 0.5rem);right:1rem;background:#fff;border-radius:0.75rem;box-shadow:0 0 0 1px rgba(0,0,0,0.08),0 8px 24px rgba(0,0,0,0.12);min-width:220px;padding:0.5rem;z-index:100;display:none;}
.menu-dropdown.open{display:block;animation:menuSlide 0.2s ease-out;}
@keyframes menuSlide{from{opacity:0;transform:translateY(-8px)}to{opacity:1;transform:translateY(0)}}
.menu-item{padding:0.65rem 0.85rem;border-radius:0.5rem;font-family:'Inter',sans-serif;font-size:0.8rem;font-weight:500;color:rgba(0,0,0,0.7);cursor:pointer;transition:all 0.15s;display:flex;align-items:center;justify-content:space-between;}
.menu-item:hover{background:rgba(0,0,0,0.04);color:rgba(0,0,0,0.9);}
.menu-item.active{background:var(--gold);color:#fff;}
.menu-item-count{font-size:0.7rem;opacity:0.6;font-weight:600;}
.brand-word{position:absolute;left:50%;transform:translateX(-50%);font-family:'Inter',sans-serif;font-size:0.65rem;font-weight:800;letter-spacing:0.22em;text-transform:uppercase;color:rgba(0,0,0,0.18);}
.slide-nav{flex-shrink:0;display:flex;align-items:center;justify-content:center;gap:2rem;padding:0.875rem 1.5rem;background:var(--white);border-top:1px solid rgba(0,0,0,0.06);}
.slide-arrow{background:transparent;border:2px solid rgba(0,0,0,0.15);width:44px;height:44px;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all 0.25s cubic-bezier(0.4,0,0.2,1);font-size:1.4rem;color:rgba(0,0,0,0.6);font-weight:600;line-height:1;padding:0;}
.slide-arrow:hover:not(:disabled){background:var(--gold);border-color:var(--gold);color:#fff;transform:scale(1.05);}
.slide-arrow:active:not(:disabled){transform:scale(0.95);}
.slide-arrow:disabled{opacity:0.25;cursor:not-allowed;}
.page-counter{font-family:'Inter',sans-serif;font-size:1rem;font-weight:600;color:rgba(0,0,0,0.5);min-width:80px;text-align:center;user-select:none;}

/* OPTIMIZED FOR PC/WHITEBOARD - NO OVERFLOW */
.infographic{
  flex:1;
  padding:2rem 3rem 1.5rem;
  overflow:hidden;
  display:flex;
  flex-direction:column;
  gap:1.25rem;
  min-height:0;
}
.info-header{
  text-align:center;
  padding-bottom:1rem;
  border-bottom:3px solid rgba(0,0,0,0.06);
  flex-shrink:0;
}
.info-title{
  font-family:'Inter',sans-serif;
  font-size:1.65rem;
  font-weight:700;
  line-height:1.25;
  color:var(--ink);
  margin-bottom:0.5rem;
}
.info-subtitle{
  font-family:'Inter',sans-serif;
  font-size:1rem;
  font-weight:500;
  color:rgba(0,0,0,0.45);
  line-height:1.4;
}
.info-context{
  font-family:'DM Sans',sans-serif;
  font-size:0.85rem;
  font-weight:400;
  color:rgba(0,0,0,0.4);
  margin-top:0.5rem;
  line-height:1.5;
}
.info-bullets{
  display:flex;
  flex-direction:column;
  gap:0.875rem;
  padding-left:0.75rem;
  flex:1;
  min-height:0;
}
.bullet-card{
  background:transparent;
  border:none;
  padding:0;
  box-shadow:none;
  position:relative;
  overflow:visible;
}
.bullet-header{
  display:flex;
  align-items:center;
  gap:1rem;
}
.bullet-dot{
  width:16px;
  height:16px;
  border-radius:50%;
  flex-shrink:0;
}
.bullet-card.health .bullet-dot{background:var(--health);}
.bullet-card.entertain .bullet-dot{background:var(--entertain);}
.bullet-card.tech .bullet-dot{background:var(--tech);}
.bullet-title{
  flex:1;
  font-family:'Inter',sans-serif;
  font-size:1.05rem;
  font-weight:600;
  color:var(--ink);
  text-transform:capitalize;
  line-height:1.4;
}

/* MOBILE RESPONSIVE */
@media(max-width:768px){
  .shell{padding:1vh 2vw;}
  .card{max-width:100%;border-radius:1rem;}
  .card-brand{padding:0.75rem 1rem 0.5rem;}
  .brand-word{font-size:0.55rem;}
  .home-link{font-size:0.9rem;padding:0.3rem 0.5rem;}
  .slide-nav{padding:0.875rem 1.25rem;gap:1.5rem;}
  .slide-arrow{width:40px;height:40px;font-size:1.3rem;}
  .page-counter{font-size:0.9rem;min-width:70px;}
  .infographic{padding:2rem 1.5rem 1.5rem;gap:1.5rem;overflow-y:auto;-webkit-overflow-scrolling:touch;}
  .info-title{font-size:1.5rem;}
  .info-subtitle{font-size:1rem;}
  .info-context{font-size:0.85rem;}
  .info-bullets{gap:1.25rem;padding-left:0.5rem;}
  .bullet-header{gap:1rem;}
  .bullet-dot{width:14px;height:14px;}
  .bullet-title{font-size:1.1rem;}
}
@media(max-width:400px){
  .shell{padding:0.5vh 1vw;}
  .card{border-radius:0.75rem;}
  .infographic{padding:1.5rem 1.25rem 1.25rem;gap:1.25rem;}
  .info-title{font-size:1.25rem;line-height:1.25;}
  .info-subtitle{font-size:0.9rem;}
  .info-context{font-size:0.75rem;}
  .info-bullets{gap:1rem;}
  .bullet-title{font-size:1rem;}
  .home-link{font-size:0.85rem;}
  .slide-arrow{width:36px;height:36px;font-size:1.2rem;}
  .page-counter{font-size:0.85rem;min-width:65px;}
}

/* LARGE SCREENS - OPTIMIZED FOR WHITEBOARD */
@media(min-width:1400px){
  .card{max-width:1200px;}
  .infographic{padding:2.5rem 4rem 2rem;gap:1.5rem;}
  .info-title{font-size:2.25rem;}
  .info-subtitle{font-size:1.25rem;}
  .info-context{font-size:1rem;}
  .bullet-dot{width:20px;height:20px;}
  .bullet-title{font-size:1.4rem;}
  .info-bullets{gap:1.25rem;}
}

/* EXTRA LARGE SCREENS */
@media(min-width:1920px){
  .card{max-width:1400px;}
  .infographic{padding:3rem 5rem 2.5rem;gap:2rem;}
  .info-title{font-size:2.75rem;}
  .info-subtitle{font-size:1.5rem;}
  .info-context{font-size:1.15rem;}
  .bullet-dot{width:24px;height:24px;}
  .bullet-title{font-size:1.65rem;}
  .info-bullets{gap:1.5rem;}
}

.card-nav{flex-shrink:0;display:flex;justify-content:center;padding:0.75rem 1.125rem calc(env(safe-area-inset-bottom,0px) + 0.875rem);background:var(--white);border-top:1px solid rgba(0,0,0,0.06);}
.nav-pill{display:flex;gap:0.15rem;background:rgba(10,10,10,0.06);border-radius:2rem;padding:0.35rem 0.4rem;}
.nb{background:transparent;border:none;padding:0.5rem 1rem;border-radius:1.5rem;font-family:'Inter',sans-serif;font-size:0.7rem;letter-spacing:0.02em;color:rgba(0,0,0,0.28);cursor:pointer;transition:all 0.24s cubic-bezier(0.4,0,0.2,1);white-space:nowrap;min-height:36px;position:relative;font-weight:500;}
.nb.on{background:var(--ink);color:var(--gold);font-weight:700;}
.nb:hover:not(.on){color:rgba(0,0,0,0.5);}
@media(max-width:768px){.card-nav{padding:0.625rem 1rem calc(env(safe-area-inset-bottom,0px) + 0.75rem);}.nb{padding:0.4rem 0.75rem;font-size:0.65rem;min-height:32px;}}
@media(max-width:400px){.nb{padding:0.35rem 0.65rem;font-size:0.6rem;}}
</style>
</head>
<body>

<div class="shell">
<div class="card">

  <div class="card-brand">
    <a href="../../../index.html?openModal=writing&submenu=essays" class="home-link">← Essays</a>
    <span class="brand-word">INTUITY</span>
    <div style="flex:1"></div>
    <div class="menu-btn" id="menuBtn" onclick="toggleMenu()">
      <div class="menu-dots"><span></span><span></span><span></span></div>
    </div>
    <div class="menu-dropdown" id="menuDropdown">
      <div class="menu-item active" onclick="filterByType('all')">
        <span>All Questions</span><span class="menu-item-count" id="count-all">0</span>
      </div>
      <div class="menu-item" onclick="filterByType('opinion')">
        <span>Opinion</span><span class="menu-item-count" id="count-opinion">0</span>
      </div>
      <div class="menu-item" onclick="filterByType('for-against')">
        <span>For &amp; Against</span><span class="menu-item-count" id="count-for-against">0</span>
      </div>
      <div class="menu-item" onclick="filterByType('problem-solution')">
        <span>Problem &amp; Solution</span><span class="menu-item-count" id="count-problem-solution">0</span>
      </div>
      <div class="menu-item" onclick="filterByType('cause-effect')">
        <span>Cause &amp; Effect</span><span class="menu-item-count" id="count-cause-effect">0</span>
      </div>
      <div class="menu-item" onclick="filterByType('speculation-trends')">
        <span>Speculation &amp; Trends</span><span class="menu-item-count" id="count-speculation-trends">0</span>
      </div>
    </div>
  </div>

  <div class="infographic"></div>

  <div class="slide-nav">
    <button class="slide-arrow" id="btnPrev" onclick="prevQ()">←</button>
    <div class="page-counter" id="pageCounter">1 / 0</div>
    <button class="slide-arrow" id="btnNext" onclick="nextQ()">→</button>
  </div>

  <div class="card-nav">
    <div class="nav-pill">
      <button class="nb on" data-mode="question" onclick="switchMode('question')">question</button>
      <button class="nb"    data-mode="plan"     onclick="switchMode('plan')">plan</button>
      <button class="nb"    data-mode="model"    onclick="switchMode('model')">model</button>
      <button class="nb"    data-mode="build"    onclick="switchMode('build')">build</button>
      <button class="nb"    data-mode="sample"   onclick="switchMode('sample')">sample</button>
    </div>
  </div>

</div>
</div>

<script>
/* ═══ STATE ═══ */
let Qs = [];
let allQs = [];
let curQ = 0;
let currentFilter = 'all';
let currentMode = 'question';

/* ═══ MENU ═══ */
function toggleMenu(){
  document.getElementById('menuDropdown').classList.toggle('open');
}
document.addEventListener('click', e => {
  const menu = document.getElementById('menuDropdown');
  const btn  = document.getElementById('menuBtn');
  if(menu && btn && !menu.contains(e.target) && !btn.contains(e.target))
    menu.classList.remove('open');
});

/* ═══ FILTER ═══ */
function filterByType(type){
  currentFilter = type;
  document.querySelectorAll('.menu-item').forEach(item => item.classList.remove('active'));
  event.target.closest('.menu-item').classList.add('active');
  Qs = (type === 'all') ? [...allQs] : allQs.filter(q => q.essayType === type);
  if(Qs.length > 0) loadQuestion(0);
  else showError(`No questions found for "${type}" essay type`);
  document.getElementById('menuDropdown').classList.remove('open');
}

/* ═══ COUNTS ═══ */
function updateCounts(){
  const types = {};
  allQs.forEach(q => { types[q.essayType] = (types[q.essayType] || 0) + 1; });
  document.getElementById('count-all').textContent              = allQs.length;
  document.getElementById('count-opinion').textContent          = types['opinion']             || 0;
  document.getElementById('count-for-against').textContent      = types['for-against']         || 0;
  document.getElementById('count-problem-solution').textContent = types['problem-solution']    || 0;
  document.getElementById('count-cause-effect').textContent     = types['cause-effect']        || 0;
  document.getElementById('count-speculation-trends').textContent = types['speculation-trends']|| 0;
}

/* ═══ LOAD JSON ═══ */
async function load(){
  document.querySelector('.infographic').innerHTML =
    `<div style="display:flex;align-items:center;justify-content:center;height:100%;">
       <div style="font-family:Inter,sans-serif;font-size:0.9rem;color:rgba(0,0,0,0.3);letter-spacing:0.08em;text-transform:uppercase;">Loading questions…</div>
     </div>`;
  try{
    const res = await fetch('data/essay-questions.json');
    if(!res.ok) throw new Error('File not found');
    const data = await res.json();
    allQs = data.questions || [];
    Qs = [...allQs];
    updateCounts();
    if(Qs.length > 0) loadQuestion(0);
    else showError('No questions found in JSON file');
  }catch(err){
    showError('Could not load data/essay-questions.json');
  }
}

function showError(msg){
  document.querySelector('.infographic').innerHTML =
    `<div style="display:flex;align-items:center;justify-content:center;height:100%;flex-direction:column;gap:1.5rem;padding:2rem;">
       <div style="font-family:Inter,sans-serif;font-size:1.1rem;color:rgba(0,0,0,0.3);text-align:center;">${msg}</div>
     </div>`;
}

/* ═══ DISPLAY ═══ */
function loadQuestion(idx){
  if(idx < 0 || idx >= Qs.length) return;
  curQ = idx;
  const q = Qs[idx];
  const colors = ['health','entertain','tech'];
  const bullets = (q.writingPoints || []).map((p,i) => `
    <div class="bullet-card ${colors[i % colors.length]}">
      <div class="bullet-header">
        <div class="bullet-dot"></div>
        <h2 class="bullet-title">${p}</h2>
      </div>
    </div>`).join('');
  document.querySelector('.infographic').innerHTML = `
    <div class="info-header">
      <h1 class="info-title">${q.mainQuestion}</h1>
      <p class="info-subtitle">Do you agree?</p>
      <p class="info-context">${q.context || ''}</p>
    </div>
    <div class="info-bullets">${bullets}</div>`;
  updateNav();
}

function updateNav(){
  document.getElementById('btnPrev').disabled = (curQ === 0);
  document.getElementById('btnNext').disabled = (curQ === Qs.length - 1);
  document.getElementById('pageCounter').textContent = `${curQ + 1} / ${Qs.length}`;
}

function prevQ(){ if(curQ > 0) loadQuestion(curQ - 1); }
function nextQ(){ if(curQ < Qs.length - 1) loadQuestion(curQ + 1); }

/* ═══ SWIPE ═══ */
let _tx = 0;
if('ontouchstart' in window){
  document.addEventListener('touchstart', e => { _tx = e.changedTouches[0].screenX; });
  document.addEventListener('touchend',   e => {
    const dx = e.changedTouches[0].screenX - _tx;
    if(dx < -50) nextQ();
    if(dx >  50) prevQ();
  });
}

/* ═══ KEYBOARD ═══ */
document.addEventListener('keydown', e => {
  if(e.key === 'ArrowLeft')  prevQ();
  if(e.key === 'ArrowRight') nextQ();
});

/* ═══ MODE SWITCHING ═══ */
function switchMode(mode){
  currentMode = mode;
  document.querySelectorAll('.nb').forEach(btn => {
    btn.classList.toggle('on', btn.dataset.mode === mode);
  });
  switch(mode){
    case 'question':
      loadQuestion(curQ);
      break;
    case 'plan':
      if(Qs[curQ]) sessionStorage.setItem('currentQuestion', JSON.stringify(Qs[curQ]));
      window.location.href = 'essay-plan.html';
      break;
    case 'model':
      if(Qs[curQ]) sessionStorage.setItem('currentQuestion', JSON.stringify(Qs[curQ]));
      window.location.href = 'essay-builder.html';
      break;
    case 'build':
      if(Qs[curQ]) sessionStorage.setItem('currentQuestion', JSON.stringify(Qs[curQ]));
      window.location.href = 'essay-builder-interactive.html';
      break;
    case 'sample':
      if(Qs[curQ]) sessionStorage.setItem('currentQuestion', JSON.stringify(Qs[curQ]));
      window.location.href = 'essay-master.html';
      break;
  }
}

/* ═══ START ═══ */
load();
</script>
</body>
</html>
