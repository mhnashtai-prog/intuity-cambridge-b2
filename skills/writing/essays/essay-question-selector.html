<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
<title>Life Today vs 100 Years Ago — Infographic</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=DM+Sans:wght@400;500;700&display=swap" rel="stylesheet"/>
<style>
/* ═══════════════════════════
   TOKENS
═══════════════════════════ */
:root{
  --bg:     #0c0c0c;
  --gold:   #C9A961;
  --gold-d: #9B7D3A;
  --gold-l: #E8D4A0;
  --white:  #FAFAF8;
  --ink:    #0d0d0d;
  
  /* Vibrant colors for bullets */
  --health: #4CAF50;
  --health-bg: rgba(76, 175, 80, 0.1);
  --entertain: #FF6B6B;
  --entertain-bg: rgba(255, 107, 107, 0.1);
  --tech: #4A90E2;
  --tech-bg: rgba(74, 144, 226, 0.1);
}

/* ═══════════════════════════
   RESET
═══════════════════════════ */
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent}
html,body{
  width:100%;height:100%;
  overflow:hidden;position:fixed;
  background:var(--bg);
  font-family:'Inter',sans-serif;
  color:#fff;
  -webkit-font-smoothing:antialiased;
}

/* ═══════════════════════════
   OUTER SHELL
═══════════════════════════ */
.shell{
  position:fixed;inset:0;
  display:flex;align-items:center;justify-content:center;
  padding:2vh 3vw;
}

/* ═══════════════════════════
   THE CARD — INFOGRAPHIC CONTAINER
═══════════════════════════ */
.card{
  width:100%;
  height:100%;
  max-width:900px;
  max-height:95vh;
  background:var(--white);
  border-radius:1.5rem;
  box-shadow:
    0 0 0 1px rgba(201,169,97,0.15),
    0 24px 80px rgba(0,0,0,0.65),
    0 4px 16px rgba(0,0,0,0.4);
  display:flex;
  flex-direction:column;
  overflow:hidden;
  position:relative;
}

/* Gold top accent */
.card::before{
  content:'';
  position:absolute;top:0;left:0;right:0;
  height:3px;
  background:linear-gradient(90deg,var(--gold-d),var(--gold-l),var(--gold-d));
  z-index:5;
}

/* ── HEADER LAYOUT ── */
.card-brand{
  flex-shrink:0;
  display:flex;align-items:center;justify-content:space-between;
  padding:1rem 1.5rem 0.75rem;
  margin-top:3px;
  position:relative;
  border-bottom:1px solid rgba(0,0,0,0.06);
}

/* Home/Back link (left) */
.home-link{
  text-decoration:none;
  font-family:'Inter',sans-serif;
  font-size:1rem;
  font-weight:600;
  color:var(--gold);
  transition:all 0.2s;
  padding:0.4rem 0.6rem;
  border-radius:0.5rem;
  display:flex;
  align-items:center;
  gap:0.3rem;
}
.home-link:hover{
  background:rgba(201,169,97,0.1);
  color:var(--gold-d);
}
.home-link:active{
  transform:scale(0.95);
}

/* Menu button (right) */
.menu-btn{
  background:#000;
  border:1px solid rgba(0,0,0,0.12);
  width:32px;
  height:32px;
  border-radius:50%;
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
  transition:all 0.2s;
}
.menu-btn:hover{
  background:rgba(0,0,0,0.85);
  border-color:rgba(0,0,0,0.2);
}
.menu-btn:active{
  transform:scale(0.95);
}
.menu-dots{
  display:flex;
  gap:4px;
}
.menu-dots span{
  width:4px;
  height:4px;
  border-radius:50%;
  background:#fff;
}

/* Dropdown menu */
.menu-dropdown{
  position:absolute;
  top:calc(100% + 0.5rem);
  right:1rem;
  background:#fff;
  border-radius:0.75rem;
  box-shadow:
    0 0 0 1px rgba(0,0,0,0.08),
    0 8px 24px rgba(0,0,0,0.12),
    0 2px 6px rgba(0,0,0,0.08);
  min-width:220px;
  padding:0.5rem;
  z-index:100;
  display:none;
}
.menu-dropdown.open{
  display:block;
  animation:menuSlide 0.2s ease-out;
}
@keyframes menuSlide{
  from{opacity:0;transform:translateY(-8px)}
  to{opacity:1;transform:translateY(0)}
}
.menu-item{
  padding:0.65rem 0.85rem;
  border-radius:0.5rem;
  font-family:'Inter',sans-serif;
  font-size:0.8rem;
  font-weight:500;
  color:rgba(0,0,0,0.7);
  cursor:pointer;
  transition:all 0.15s;
  display:flex;
  align-items:center;
  justify-content:space-between;
}
.menu-item:hover{
  background:rgba(0,0,0,0.04);
  color:rgba(0,0,0,0.9);
}
.menu-item.active{
  background:var(--gold);
  color:#fff;
}
.menu-item-count{
  font-size:0.7rem;
  opacity:0.6;
  font-weight:600;
}

/* Brand word (center) */
.brand-word{
  position:absolute;
  left:50%;
  transform:translateX(-50%);
  font-family:'Inter',sans-serif;
  font-size:0.65rem;font-weight:800;
  letter-spacing:0.22em;text-transform:uppercase;
  color:rgba(0,0,0,0.18);
}

/* ═══════════════════════════
   SLIDE NAVIGATION (UNDER CONTENT)
═══════════════════════════ */
.slide-nav{
  flex-shrink:0;
  display:flex;
  align-items:center;
  justify-content:center;
  gap:2rem;
  padding:1rem 1.5rem;
  background:var(--white);
  border-top:1px solid rgba(0,0,0,0.06);
}

.slide-arrow{
  background:transparent;
  border:2px solid rgba(0,0,0,0.15);
  width:44px;
  height:44px;
  border-radius:50%;
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
  transition:all 0.25s cubic-bezier(0.4,0,0.2,1);
  font-size:1.4rem;
  color:rgba(0,0,0,0.6);
  font-weight:600;
  line-height:1;
  padding:0;
}

.slide-arrow:hover:not(:disabled){
  background:var(--gold);
  border-color:var(--gold);
  color:#fff;
  transform:scale(1.05);
}

.slide-arrow:active:not(:disabled){
  transform:scale(0.95);
}

.slide-arrow:disabled{
  opacity:0.25;
  cursor:not-allowed;
}

.page-counter{
  font-family:'Inter',sans-serif;
  font-size:1rem;
  font-weight:600;
  color:rgba(0,0,0,0.5);
  min-width:80px;
  text-align:center;
  user-select:none;
}

/* ═══════════════════════════
   INFOGRAPHIC CONTENT
═══════════════════════════ */
.infographic{
  flex:1;
  padding:3.5rem 4rem 3.5rem;
  overflow-y:auto;
  -webkit-overflow-scrolling:touch;
  display:flex;
  flex-direction:column;
  gap:3.5rem;
}
.infographic::-webkit-scrollbar{display:none}

/* Header */
.info-header{
  text-align:center;
  padding-bottom:2.5rem;
  border-bottom:3px solid rgba(0,0,0,0.06);
}

.info-title{
  font-family:'Inter',sans-serif;
  font-size:3rem;
  font-weight:700;
  line-height:1.2;
  color:var(--ink);
  margin-bottom:1rem;
}

.info-subtitle{
  font-family:'Inter',sans-serif;
  font-size:1.5rem;
  font-weight:500;
  color:rgba(0,0,0,0.45);
  line-height:1.6;
}

.info-context{
  font-family:'DM Sans',sans-serif;
  font-size:1.1rem;
  font-weight:400;
  color:rgba(0,0,0,0.4);
  margin-top:1rem;
}

/* Bullet Points Section */
.info-bullets{
  display:flex;
  flex-direction:column;
  gap:2.5rem;
  padding-left:1rem;
}

.bullet-card{
  background:transparent;
  border:none;
  padding:0;
  box-shadow:none;
  position:relative;
  overflow:visible;
}

/* Bullet header */
.bullet-header{
  display:flex;
  align-items:center;
  gap:1.5rem;
}

.bullet-dot{
  width:20px;
  height:20px;
  border-radius:50%;
  flex-shrink:0;
}

.bullet-card.health .bullet-dot{
  background:var(--health);
}
.bullet-card.entertain .bullet-dot{
  background:var(--entertain);
}
.bullet-card.tech .bullet-dot{
  background:var(--tech);
}

.bullet-title{
  flex:1;
  font-family:'Inter',sans-serif;
  font-size:1.75rem;
  font-weight:600;
  color:var(--ink);
  text-transform:capitalize;
}

/* ═══════════════════════════
   RESPONSIVE - MOBILE/TABLET
═══════════════════════════ */
@media (max-width: 768px){
  .shell{
    padding:1vh 2vw;
  }
  
  .card{
    max-width:100%;
    border-radius:1rem;
  }
  
  .card-brand{
    padding:0.75rem 1rem 0.5rem;
  }
  
  .brand-word{
    font-size:0.55rem;
  }
  
  .home-link{
    font-size:0.9rem;
    padding:0.3rem 0.5rem;
  }
  
  .slide-nav{
    padding:0.875rem 1.25rem;
    gap:1.5rem;
  }
  
  .slide-arrow{
    width:40px;
    height:40px;
    font-size:1.3rem;
  }
  
  .page-counter{
    font-size:0.9rem;
    min-width:70px;
  }
  
  .infographic{
    padding:2.5rem 1.5rem 2rem;
    gap:2rem;
  }
  
  .info-header{
    padding-bottom:1.5rem;
    border-bottom:2px solid rgba(0,0,0,0.06);
  }
  
  .info-title{
    font-size:1.5rem;
    margin-bottom:0.75rem;
  }
  
  .info-subtitle{
    font-size:1rem;
  }
  
  .info-context{
    font-size:0.85rem;
    margin-top:0.75rem;
  }
  
  .info-bullets{
    gap:1.5rem;
    padding-left:0.5rem;
  }
  
  .bullet-header{
    gap:1rem;
  }
  
  .bullet-dot{
    width:14px;
    height:14px;
  }
  
  .bullet-title{
    font-size:1.1rem;
  }
}

/* ═══════════════════════════
   RESPONSIVE - SMALL PHONES
═══════════════════════════ */
@media (max-width: 400px){
  .shell{
    padding:0.5vh 1vw;
  }
  
  .card{
    border-radius:0.75rem;
  }
  
  .infographic{
    padding:2rem 1.25rem 1.5rem;
    gap:1.75rem;
  }
  
  .info-title{
    font-size:1.25rem;
    line-height:1.25;
  }
  
  .info-subtitle{
    font-size:0.9rem;
  }
  
  .info-context{
    font-size:0.75rem;
  }
  
  .info-bullets{
    gap:1.25rem;
  }
  
  .bullet-title{
    font-size:1rem;
  }
  
  .home-link{
    font-size:0.85rem;
  }
  
  .slide-arrow{
    width:36px;
    height:36px;
    font-size:1.2rem;
  }
  
  .page-counter{
    font-size:0.85rem;
    min-width:65px;
  }
}

/* ═══════════════════════════
   RESPONSIVE - LARGE SCREENS (PROJECTOR)
═══════════════════════════ */
@media (min-width: 1400px){
  .card{
    max-width:1200px;
  }
  
  .infographic{
    padding:4rem 5rem 4rem;
    gap:4rem;
  }
  
  .info-title{
    font-size:3.5rem;
  }
  
  .info-subtitle{
    font-size:1.75rem;
  }
  
  .info-context{
    font-size:1.25rem;
  }
  
  .bullet-dot{
    width:24px;
    height:24px;
  }
  
  .bullet-title{
    font-size:2rem;
  }
}

/* ═══════════════════════════
   NAV PILLS — INSIDE CARD
═══════════════════════════ */
.card-nav{
  flex-shrink:0;
  display:flex;justify-content:center;
  padding:0.75rem 1.125rem
    calc(env(safe-area-inset-bottom,0px) + 0.875rem);
  background:var(--white);
  border-top:1px solid rgba(0,0,0,0.06);
}
.nav-pill{
  display:flex;gap:0.125rem;
  background:rgba(10,10,10,0.06);
  border-radius:2rem;
  padding:0.35rem 0.4rem;
  gap:0.15rem;
}
.nb{
  background:transparent;border:none;
  padding:0.5rem 1rem;border-radius:1.5rem;
  font-family:'Inter',sans-serif;
  font-size:0.7rem;letter-spacing:0.02em;
  color:rgba(0,0,0,0.28);
  cursor:pointer;
  transition:all 0.24s cubic-bezier(0.4,0,0.2,1);
  white-space:nowrap;min-height:36px;
  position:relative;
  font-weight:500;
}
.nb.on{
  background:var(--ink);
  color:var(--gold);
  font-weight:700;
}
.nb:hover:not(.on){
  color:rgba(0,0,0,0.5);
}

/* Responsive nav pills */
@media (max-width: 768px){
  .card-nav{
    padding:0.625rem 1rem calc(env(safe-area-inset-bottom,0px) + 0.75rem);
  }
  
  .nb{
    padding:0.4rem 0.75rem;
    font-size:0.65rem;
    min-height:32px;
  }
}

@media (max-width: 400px){
  .nb{
    padding:0.35rem 0.65rem;
    font-size:0.6rem;
  }
}
</style>
</head>
<body>

<div class="shell">
<div class="card">

  <!-- HEADER: back link + brand + menu -->
  <div class="card-brand">
    <a href="../../../index.html?openModal=writing&submenu=essays" class="home-link">← Essays</a>
    
    <!-- Brand word (center) -->
    <span class="brand-word">INTUITY</span>
    
    <!-- Spacer to push menu to right -->
    <div style="flex:1"></div>
    
    <!-- Menu button (right) -->
    <div class="menu-btn" id="menuBtn" onclick="toggleMenu()">
      <div class="menu-dots">
        <span></span>
        <span></span>
        <span></span>
      </div>
    </div>
    
    <!-- Dropdown menu -->
    <div class="menu-dropdown" id="menuDropdown">
      <div class="menu-item active" onclick="filterByType('all')">
        <span>All Questions</span>
        <span class="menu-item-count" id="count-all">25</span>
      </div>
      <div class="menu-item" onclick="filterByType('opinion')">
        <span>Opinion</span>
        <span class="menu-item-count" id="count-opinion">0</span>
      </div>
      <div class="menu-item" onclick="filterByType('for-against')">
        <span>For & Against</span>
        <span class="menu-item-count" id="count-for-against">0</span>
      </div>
      <div class="menu-item" onclick="filterByType('problem-solution')">
        <span>Problem & Solution</span>
        <span class="menu-item-count" id="count-problem-solution">0</span>
      </div>
      <div class="menu-item" onclick="filterByType('cause-effect')">
        <span>Cause & Effect</span>
        <span class="menu-item-count" id="count-cause-effect">0</span>
      </div>
      <div class="menu-item" onclick="filterByType('speculation-trends')">
        <span>Speculation & Trends</span>
        <span class="menu-item-count" id="count-speculation-trends">0</span>
      </div>
    </div>
    
    <!-- Page indicators (center bottom) -->
    <div class="q-pips" id="qPips">
      <!-- Pips will be generated dynamically -->
    </div>
  </div>
  
  <div class="infographic">
    <!-- Content will be loaded dynamically from JSON -->
  </div>

  <!-- SLIDE NAVIGATION -->
  <div class="slide-nav">
    <button class="slide-arrow" id="btnPrev" onclick="prevQ()">←</button>
    <div class="page-counter" id="pageCounter">1 / 25</div>
    <button class="slide-arrow" id="btnNext" onclick="nextQ()">→</button>
  </div>

  <!-- NAV PILLS — INSIDE CARD -->
  <div class="card-nav">
    <div class="nav-pill">
      <button class="nb on" data-m="0">question</button>
      <button class="nb" data-m="1">plan</button>
      <button class="nb" data-m="2">model</button>
      <button class="nb" data-m="3">sample</button>
    </div>
  </div>

</div>
</div>

<script>
/* ═══ STATE ═══ */
let Qs = [];
let allQs = [];
let curQ = 0;
let currentFilter = 'all';

/* ═══ MENU TOGGLE ═══ */
function toggleMenu(){
  const menu = document.getElementById('menuDropdown');
  menu.classList.toggle('open');
}

// Close menu when clicking outside
document.addEventListener('click', (e) => {
  const menu = document.getElementById('menuDropdown');
  const btn = document.getElementById('menuBtn');
  if(menu && btn && !menu.contains(e.target) && !btn.contains(e.target)){
    menu.classList.remove('open');
  }
});

/* ═══ FILTER BY TYPE ═══ */
function filterByType(type){
  currentFilter = type;
  
  // Update active state
  document.querySelectorAll('.menu-item').forEach(item => {
    item.classList.remove('active');
  });
  event.target.closest('.menu-item').classList.add('active');
  
  // Filter questions
  if(type === 'all'){
    Qs = [...allQs];
  } else {
    Qs = allQs.filter(q => q.essayType === type);
  }
  
  // Load first question of filtered set
  if(Qs.length > 0){
    loadQuestion(0);
  } else {
    showError(`No questions found for "${type}" essay type`);
  }
  
  // Close menu
  document.getElementById('menuDropdown').classList.remove('open');
}

/* ═══ UPDATE COUNTS ═══ */
function updateCounts(){
  const types = {};
  allQs.forEach(q => {
    types[q.essayType] = (types[q.essayType] || 0) + 1;
  });
  
  document.getElementById('count-all').textContent = allQs.length;
  document.getElementById('count-opinion').textContent = types['opinion'] || 0;
  document.getElementById('count-for-against').textContent = types['for-against'] || 0;
  document.getElementById('count-problem-solution').textContent = types['problem-solution'] || 0;
  document.getElementById('count-cause-effect').textContent = types['cause-effect'] || 0;
  document.getElementById('count-speculation-trends').textContent = types['speculation-trends'] || 0;
}

/* ═══ LOAD & DISPLAY ═══ */
async function load(){
  // Show loading state
  document.querySelector('.infographic').innerHTML = `
    <div style="display:flex;align-items:center;justify-content:center;height:100%;flex-direction:column;gap:1rem;">
      <div style="font-family:Inter,sans-serif;font-size:0.9rem;color:rgba(0,0,0,0.3);letter-spacing:0.08em;text-transform:uppercase;">Loading questions...</div>
    </div>`;
  
  try{
    const response = await fetch('essay-questions.json');
    if(response.ok){
      const data = await response.json();
      allQs = data.questions || [];
      Qs = [...allQs];
      console.log(`✓ Loaded ${Qs.length} questions`);
      
      updateCounts();
      
      if(Qs.length > 0){
        loadQuestion(0);
      } else {
        showError('No questions found in JSON file');
      }
    } else {
      showError('Could not load essay-questions.json');
    }
  }catch(err){
    console.error('Error loading questions:', err);
    showError('Please place essay-questions.json in the same folder as this HTML file');
  }
}

function showError(message){
  document.querySelector('.infographic').innerHTML = `
    <div style="display:flex;align-items:center;justify-content:center;height:100%;flex-direction:column;gap:1.5rem;padding:2rem;">
      <div style="font-family:Inter,sans-serif;font-size:1.2rem;color:rgba(0,0,0,0.2);letter-spacing:0.04em;text-transform:uppercase;text-align:center;">
        ${message}
      </div>
      <div style="font-family:Inter,sans-serif;font-size:0.85rem;color:rgba(0,0,0,0.35);line-height:1.6;text-align:center;max-width:400px;">
        Make sure <strong>essay-questions.json</strong> is in the same directory as this HTML file, then refresh the page.
      </div>
    </div>`;
}

function loadQuestion(idx){
  if(idx < 0 || idx >= Qs.length) return;
  curQ = idx;
  const q = Qs[idx];
  
  // Build bullet points
  const bullets = (q.writingPoints || []).map((p, i) => {
    const colors = ['health', 'entertain', 'tech'];
    const colorClass = colors[i % colors.length];
    return `
      <div class="bullet-card ${colorClass}">
        <div class="bullet-header">
          <div class="bullet-dot"></div>
          <h2 class="bullet-title">${p}</h2>
        </div>
      </div>`;
  }).join('');
  
  // Update the content
  document.querySelector('.infographic').innerHTML = `
    <div class="info-header">
      <h1 class="info-title">${q.mainQuestion}</h1>
      <p class="info-subtitle">Do you agree?</p>
      <p class="info-context">${q.context || ''}</p>
    </div>
    <div class="info-bullets">
      ${bullets}
    </div>`;
  
  updateNav();
}

function updateNav(){
  // Update arrow buttons
  const prevBtn = document.getElementById('btnPrev');
  const nextBtn = document.getElementById('btnNext');
  if(prevBtn) prevBtn.disabled = (curQ === 0);
  if(nextBtn) nextBtn.disabled = (curQ === Qs.length - 1);
  
  // Update page counter
  const pageCounter = document.getElementById('pageCounter');
  if(pageCounter){
    pageCounter.textContent = `${curQ + 1} / ${Qs.length}`;
  }
}

function prevQ(){
  if(curQ > 0) loadQuestion(curQ - 1);
}

function nextQ(){
  if(curQ < Qs.length - 1) loadQuestion(curQ + 1);
}

/* ═══ SWIPE GESTURE NAVIGATION ═══ */
let touchStartX = 0;
let touchEndX = 0;

document.addEventListener('touchstart', e => {
  touchStartX = e.changedTouches[0].screenX;
});

document.addEventListener('touchend', e => {
  touchEndX = e.changedTouches[0].screenX;
  handleSwipe();
});

function handleSwipe() {
  if (touchEndX < touchStartX - 50) {
    // Swipe left - next question
    nextQ();
  }
  if (touchEndX > touchStartX + 50) {
    // Swipe right - previous question
    prevQ();
  }
}

/* ═══ KEYBOARD NAVIGATION ═══ */
document.addEventListener('keydown', e => {
  if(e.key === 'ArrowLeft') prevQ();
  if(e.key === 'ArrowRight') nextQ();
});

/* ═══ START ═══ */
load();
</script>

</body>
</html>
