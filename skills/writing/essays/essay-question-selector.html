<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
<title>Essay Question — INTUITY</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=SF+Pro+Display:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet"/>
<style>
:root{
  --bg:#000;
  --white:#fff;
  --gold:#C9A961;
  --gold-d:#9B7D3A;
  --gray:#8e8e93;
  --gray-light:#d1d1d6;
}
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent}
html,body{width:100%;height:100%;overflow:hidden;position:fixed;background:var(--bg);font-family:'SF Pro Display','Inter',sans-serif;color:var(--white);-webkit-font-smoothing:antialiased;}

/* FULL SCREEN STAGE */
.stage{
  position:fixed;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:5vh 8vw;
}

/* MINIMAL TOP BAR */
.top-bar{
  position:fixed;
  top:0;
  left:0;
  right:0;
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:1.5rem 3rem;
  z-index:100;
  opacity:0.6;
  transition:opacity 0.3s;
}
.top-bar:hover{opacity:1;}

.home-link{
  text-decoration:none;
  font-size:0.875rem;
  font-weight:500;
  color:var(--gray);
  transition:color 0.2s;
  letter-spacing:0.02em;
}
.home-link:hover{color:var(--white);}

.brand{
  position:absolute;
  left:50%;
  transform:translateX(-50%);
  font-size:0.75rem;
  font-weight:700;
  letter-spacing:0.25em;
  text-transform:uppercase;
  color:var(--gray);
}

.menu-btn{
  width:32px;
  height:32px;
  border-radius:50%;
  background:rgba(255,255,255,0.1);
  border:1px solid rgba(255,255,255,0.15);
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
  transition:all 0.2s;
}
.menu-btn:hover{background:rgba(255,255,255,0.15);}
.menu-dots{display:flex;gap:3px;}
.menu-dots span{width:3px;height:3px;border-radius:50%;background:var(--white);}

.menu-dropdown{
  position:absolute;
  top:calc(100% + 0.5rem);
  right:3rem;
  background:rgba(28,28,30,0.95);
  backdrop-filter:blur(40px);
  border-radius:1rem;
  box-shadow:0 20px 60px rgba(0,0,0,0.5);
  min-width:200px;
  padding:0.5rem;
  z-index:200;
  display:none;
  border:1px solid rgba(255,255,255,0.1);
}
.menu-dropdown.open{display:block;animation:menuFade 0.2s ease-out;}
@keyframes menuFade{from{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}
.menu-item{
  padding:0.75rem 1rem;
  border-radius:0.5rem;
  font-size:0.8rem;
  font-weight:500;
  color:var(--gray-light);
  cursor:pointer;
  transition:all 0.15s;
  display:flex;
  align-items:center;
  justify-content:space-between;
}
.menu-item:hover{background:rgba(255,255,255,0.1);color:var(--white);}
.menu-item.active{background:var(--gold);color:var(--bg);}
.menu-item-count{font-size:0.7rem;opacity:0.7;font-weight:600;}

/* HERO CONTENT */
.hero{
  text-align:center;
  max-width:1200px;
  animation:fadeInUp 0.8s cubic-bezier(0.16,1,0.3,1);
}

@keyframes fadeInUp{
  from{opacity:0;transform:translateY(40px)}
  to{opacity:1;transform:translateY(0)}
}

.question{
  font-size:clamp(2.5rem, 5vw, 5.5rem);
  font-weight:700;
  line-height:1.1;
  margin-bottom:2rem;
  letter-spacing:-0.02em;
  color:var(--white);
}

.subline{
  font-size:clamp(1.5rem, 3vw, 2.5rem);
  font-weight:300;
  color:var(--gray-light);
  margin-bottom:3rem;
  letter-spacing:-0.01em;
}

.context{
  font-size:clamp(1rem, 1.5vw, 1.25rem);
  font-weight:400;
  color:var(--gray);
  margin-bottom:4rem;
  line-height:1.6;
  max-width:800px;
  margin-left:auto;
  margin-right:auto;
}

/* BULLET POINTS - ONE AT A TIME */
.bullets{
  display:flex;
  flex-direction:column;
  gap:1.5rem;
  max-width:900px;
  margin:0 auto;
}

.bullet{
  display:flex;
  align-items:center;
  gap:1.5rem;
  opacity:0;
  animation:fadeInUp 0.6s cubic-bezier(0.16,1,0.3,1) forwards;
}

.bullet:nth-child(1){animation-delay:0.2s;}
.bullet:nth-child(2){animation-delay:0.4s;}
.bullet:nth-child(3){animation-delay:0.6s;}

.bullet-dot{
  width:12px;
  height:12px;
  border-radius:50%;
  flex-shrink:0;
  background:var(--gold);
}

.bullet-text{
  font-size:clamp(1.25rem, 2vw, 1.75rem);
  font-weight:500;
  color:var(--white);
  line-height:1.4;
  letter-spacing:-0.01em;
}

/* MINIMAL BOTTOM NAV */
.bottom-nav{
  position:fixed;
  bottom:0;
  left:0;
  right:0;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:2rem 3rem;
  gap:3rem;
  z-index:100;
  opacity:0.6;
  transition:opacity 0.3s;
}
.bottom-nav:hover{opacity:1;}

.nav-arrow{
  width:48px;
  height:48px;
  border-radius:50%;
  background:rgba(255,255,255,0.1);
  border:1px solid rgba(255,255,255,0.15);
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
  transition:all 0.25s cubic-bezier(0.16,1,0.3,1);
  font-size:1.5rem;
  color:var(--white);
  backdrop-filter:blur(20px);
}
.nav-arrow:hover:not(:disabled){
  background:var(--gold);
  border-color:var(--gold);
  transform:scale(1.05);
}
.nav-arrow:active:not(:disabled){transform:scale(0.95);}
.nav-arrow:disabled{opacity:0.2;cursor:not-allowed;}

.page-indicator{
  font-size:0.875rem;
  font-weight:500;
  color:var(--gray);
  min-width:60px;
  text-align:center;
  letter-spacing:0.02em;
}

/* MODE PILLS */
.mode-nav{
  position:fixed;
  bottom:2rem;
  left:50%;
  transform:translateX(-50%);
  display:flex;
  gap:0.25rem;
  background:rgba(28,28,30,0.8);
  backdrop-filter:blur(40px);
  border-radius:2rem;
  padding:0.375rem;
  z-index:90;
  border:1px solid rgba(255,255,255,0.1);
}

.mode-btn{
  background:transparent;
  border:none;
  padding:0.5rem 1.125rem;
  border-radius:1.5rem;
  font-size:0.75rem;
  letter-spacing:0.02em;
  color:var(--gray);
  cursor:pointer;
  transition:all 0.2s;
  white-space:nowrap;
  font-weight:500;
}
.mode-btn.on{
  background:var(--gold);
  color:var(--bg);
  font-weight:600;
}
.mode-btn:hover:not(.on){color:var(--white);}

/* MOBILE ADJUSTMENTS */
@media(max-width:768px){
  .stage{padding:3vh 5vw;}
  .top-bar{padding:1rem 1.5rem;}
  .bottom-nav{padding:1.5rem 1.5rem;gap:2rem;}
  .nav-arrow{width:44px;height:44px;font-size:1.3rem;}
  .question{font-size:2rem;margin-bottom:1.5rem;}
  .subline{font-size:1.25rem;margin-bottom:2rem;}
  .context{font-size:0.9rem;margin-bottom:2.5rem;}
  .bullet-text{font-size:1.1rem;}
  .bullets{gap:1.25rem;}
  .mode-nav{bottom:1.5rem;}
  .mode-btn{padding:0.4rem 0.875rem;font-size:0.7rem;}
}

@media(max-width:400px){
  .stage{padding:2vh 4vw;}
  .top-bar{padding:0.75rem 1rem;}
  .brand{font-size:0.65rem;}
  .home-link{font-size:0.75rem;}
  .question{font-size:1.5rem;}
  .subline{font-size:1rem;}
  .context{font-size:0.8rem;}
  .bullet-text{font-size:1rem;}
  .nav-arrow{width:40px;height:40px;}
  .mode-btn{padding:0.35rem 0.75rem;font-size:0.65rem;}
}
</style>
</head>
<body>

<div class="top-bar">
  <a href="../../../index.html?openModal=writing&submenu=essays" class="home-link">← Essays</a>
  <span class="brand">INTUITY</span>
  <div class="menu-btn" id="menuBtn" onclick="toggleMenu()">
    <div class="menu-dots"><span></span><span></span><span></span></div>
  </div>
  <div class="menu-dropdown" id="menuDropdown">
    <div class="menu-item active" onclick="filterByType('all')">
      <span>All Questions</span><span class="menu-item-count" id="count-all">0</span>
    </div>
    <div class="menu-item" onclick="filterByType('opinion')">
      <span>Opinion</span><span class="menu-item-count" id="count-opinion">0</span>
    </div>
    <div class="menu-item" onclick="filterByType('for-against')">
      <span>For &amp; Against</span><span class="menu-item-count" id="count-for-against">0</span>
    </div>
    <div class="menu-item" onclick="filterByType('problem-solution')">
      <span>Problem &amp; Solution</span><span class="menu-item-count" id="count-problem-solution">0</span>
    </div>
    <div class="menu-item" onclick="filterByType('cause-effect')">
      <span>Cause &amp; Effect</span><span class="menu-item-count" id="count-cause-effect">0</span>
    </div>
    <div class="menu-item" onclick="filterByType('speculation-trends')">
      <span>Speculation &amp; Trends</span><span class="menu-item-count" id="count-speculation-trends">0</span>
    </div>
  </div>
</div>

<div class="stage" id="stage"></div>

<div class="bottom-nav">
  <button class="nav-arrow" id="btnPrev" onclick="prevQ()">←</button>
  <div class="page-indicator" id="pageIndicator">1 / 0</div>
  <button class="nav-arrow" id="btnNext" onclick="nextQ()">→</button>
</div>

<div class="mode-nav">
  <button class="mode-btn on" data-mode="question" onclick="switchMode('question')">question</button>
  <button class="mode-btn" data-mode="plan" onclick="switchMode('plan')">plan</button>
  <button class="mode-btn" data-mode="model" onclick="switchMode('model')">model</button>
  <button class="mode-btn" data-mode="build" onclick="switchMode('build')">build</button>
  <button class="mode-btn" data-mode="sample" onclick="switchMode('sample')">sample</button>
</div>

<script>
/* STATE */
let Qs = [];
let allQs = [];
let curQ = 0;
let currentFilter = 'all';
let currentMode = 'question';

/* MENU */
function toggleMenu(){
  document.getElementById('menuDropdown').classList.toggle('open');
}
document.addEventListener('click', e => {
  const menu = document.getElementById('menuDropdown');
  const btn = document.getElementById('menuBtn');
  if(menu && btn && !menu.contains(e.target) && !btn.contains(e.target))
    menu.classList.remove('open');
});

/* FILTER */
function filterByType(type){
  currentFilter = type;
  document.querySelectorAll('.menu-item').forEach(item => item.classList.remove('active'));
  event.target.closest('.menu-item').classList.add('active');
  Qs = (type === 'all') ? [...allQs] : allQs.filter(q => q.essayType === type);
  if(Qs.length > 0) loadQuestion(0);
  else showError(`No questions found for "${type}"`);
  document.getElementById('menuDropdown').classList.remove('open');
}

/* COUNTS */
function updateCounts(){
  const types = {};
  allQs.forEach(q => { types[q.essayType] = (types[q.essayType] || 0) + 1; });
  document.getElementById('count-all').textContent = allQs.length;
  document.getElementById('count-opinion').textContent = types['opinion'] || 0;
  document.getElementById('count-for-against').textContent = types['for-against'] || 0;
  document.getElementById('count-problem-solution').textContent = types['problem-solution'] || 0;
  document.getElementById('count-cause-effect').textContent = types['cause-effect'] || 0;
  document.getElementById('count-speculation-trends').textContent = types['speculation-trends'] || 0;
}

/* LOAD JSON */
async function load(){
  document.getElementById('stage').innerHTML =
    `<div style="font-size:0.875rem;color:#8e8e93;letter-spacing:0.1em;text-transform:uppercase;">Loading…</div>`;
  try{
    const res = await fetch('data/essay-questions.json');
    if(!res.ok) throw new Error('File not found');
    const data = await res.json();
    allQs = data.questions || [];
    Qs = [...allQs];
    updateCounts();
    if(Qs.length > 0) loadQuestion(0);
    else showError('No questions found');
  }catch(err){
    showError('Could not load data');
  }
}

function showError(msg){
  document.getElementById('stage').innerHTML =
    `<div style="font-size:1rem;color:#8e8e93;text-align:center;">${msg}</div>`;
}

/* DISPLAY - STEVE JOBS STYLE */
function loadQuestion(idx){
  if(idx < 0 || idx >= Qs.length) return;
  curQ = idx;
  const q = Qs[idx];
  
  const bullets = (q.writingPoints || []).map(p => `
    <div class="bullet">
      <div class="bullet-dot"></div>
      <div class="bullet-text">${p}</div>
    </div>
  `).join('');
  
  document.getElementById('stage').innerHTML = `
    <div class="hero">
      <h1 class="question">${q.mainQuestion}</h1>
      <p class="subline">Do you agree?</p>
      ${q.context ? `<p class="context">${q.context}</p>` : ''}
      <div class="bullets">${bullets}</div>
    </div>
  `;
  
  updateNav();
}

function updateNav(){
  document.getElementById('btnPrev').disabled = (curQ === 0);
  document.getElementById('btnNext').disabled = (curQ === Qs.length - 1);
  document.getElementById('pageIndicator').textContent = `${curQ + 1} / ${Qs.length}`;
}

function prevQ(){ if(curQ > 0) loadQuestion(curQ - 1); }
function nextQ(){ if(curQ < Qs.length - 1) loadQuestion(curQ + 1); }

/* SWIPE */
let _tx = 0;
if('ontouchstart' in window){
  document.addEventListener('touchstart', e => { _tx = e.changedTouches[0].screenX; });
  document.addEventListener('touchend', e => {
    const dx = e.changedTouches[0].screenX - _tx;
    if(dx < -50) nextQ();
    if(dx > 50) prevQ();
  });
}

/* KEYBOARD */
document.addEventListener('keydown', e => {
  if(e.key === 'ArrowLeft') prevQ();
  if(e.key === 'ArrowRight') nextQ();
  if(e.key === ' ') nextQ();
});

/* MODE SWITCHING */
function switchMode(mode){
  currentMode = mode;
  document.querySelectorAll('.mode-btn').forEach(btn => {
    btn.classList.toggle('on', btn.dataset.mode === mode);
  });
  switch(mode){
    case 'question':
      loadQuestion(curQ);
      break;
    case 'plan':
      if(Qs[curQ]) sessionStorage.setItem('currentQuestion', JSON.stringify(Qs[curQ]));
      window.location.href = 'essay-plan.html';
      break;
    case 'model':
      if(Qs[curQ]) sessionStorage.setItem('currentQuestion', JSON.stringify(Qs[curQ]));
      window.location.href = 'essay-builder.html';
      break;
    case 'build':
      if(Qs[curQ]) sessionStorage.setItem('currentQuestion', JSON.stringify(Qs[curQ]));
      window.location.href = 'essay-builder-interactive.html';
      break;
    case 'sample':
      if(Qs[curQ]) sessionStorage.setItem('currentQuestion', JSON.stringify(Qs[curQ]));
      window.location.href = 'essay-master.html';
      break;
  }
}

/* START */
load();
</script>
</body>
</html>
